dist: xenial
language: python
python:
  - '3.7'
install:
  - pip install awscli --upgrade
  - pip install moto
  - npm install serverless -g
  - npm install serverless-iam-roles-per-function
  - serverless plugin install -n serverless-python-requirements
before_script:
  - export BOTO_CONFIG=/dev/null
script:
  - pytest
  - serverless deploy --stage ci
  - serverless invoke --stage ci --function AutoRemediateSetup --log
  - serverless remove --stage ci